<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Dashboard Admin - KDMP Sidorejo</title>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<style>
  body{font-family:'Poppins',sans-serif;background:#f5f7fa;margin:0;color:#333;}
  header{background:#004aad;color:#fff;padding:15px;text-align:center;}
  .container{max-width:1000px;margin:20px auto;padding:20px;background:#fff;border-radius:10px;box-shadow:0 4px 10px rgba(0,0,0,0.05);}
  table{width:100%;border-collapse:collapse;}
  th,td{padding:10px;border:1px solid #ddd;text-align:left;}
  th{background:#004aad;color:#fff;}
  button{padding:8px 16px;margin:5px;border:none;border-radius:8px;cursor:pointer;}
  .export{background:#10b981;color:#fff;}
  .delete{background:#ef4444;color:#fff;}
  .logout{background:#6b7280;color:#fff;float:right;}
</style>
</head>
<body>
<header>
  <h1>Dashboard Admin KDMP Sidorejo</h1>
  <button class="logout" onclick="logout()">Logout</button>
</header>

<div class="container">
  <h2>Data Pendaftaran Anggota</h2>
  <div style="margin-bottom:10px;">
    <button class="export" id="exportExcel">‚¨áÔ∏è Ekspor ke Excel</button>
    <button class="delete" onclick="hapusData()">üóëÔ∏è Hapus Semua Data</button>
  </div>
  <table id="dataTable">
    <thead>
      <tr><th>Nama</th><th>Nomor HP</th><th>Alamat</th><th>Pekerjaan</th><th>Simpanan</th><th>Tanggal</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script>
  if(localStorage.getItem('isLoggedIn')!=='true'){window.location.href='login.html';}

  function tampilData(){
    const data=JSON.parse(localStorage.getItem('pendaftaran')||'[]');
    const tbody=document.querySelector('#dataTable tbody');
    tbody.innerHTML='';
    data.forEach(d=>{
      const row=document.createElement('tr');
      row.innerHTML=`<td>${d.nama}</td><td>${d.hp}</td><td>${d.alamat}</td><td>${d.pekerjaan}</td><td>${d.simpanan}</td><td>${d.tanggal}</td>`;
      tbody.appendChild(row);
    });
  }
  tampilData();

  document.getElementById('exportExcel').addEventListener('click',()=>{
    const data=JSON.parse(localStorage.getItem('pendaftaran')||'[]');
    if(data.length===0){alert('Belum ada data!');return;}
    const ws=XLSX.utils.json_to_sheet(data);
    const wb=XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb,ws,'Data Anggota');
    XLSX.writeFile(wb,'Data_Anggota_KDMP.xlsx');
  });

  function hapusData(){
    if(confirm('Yakin hapus semua data?')){
      localStorage.removeItem('pendaftaran');
      tampilData();
    }
  }
  function logout(){
    localStorage.removeItem('isLoggedIn');
    window.location.href='login.html';
  }
</script>
</body>
</html>